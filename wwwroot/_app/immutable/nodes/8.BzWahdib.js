import{p as X,a as u,t as N,f as b}from"../chunks/D__f5P3N.js";import"../chunks/DYHuzUNG.js";import{p as Y,D as O,J as Z,a as ee,s as o,f as D,w as r,C as $,c as _,t as z,G as re,F as w,r as h}from"../chunks/DJxnAQxZ.js";import{d as te,c as ae,B as se,b as oe}from"../chunks/BE4kj85j.js";import{s as le}from"../chunks/CKTSjATE.js";import{p as ie,b as ne,i as de,r as ue}from"../chunks/JpLCEfp9.js";import{g as V}from"../chunks/DxqAJtII.js";import{p as ce}from"../chunks/C7fXCa3B.js";import{F as me,a as L,b as G,I as R,H as U,c as fe,l as q}from"../chunks/C8kaujdF.js";import{c as ve,a as pe,A as ge}from"../chunks/KB_K6DwI.js";import{S as $e}from"../chunks/D57HcRkC.js";import{l as _e}from"../chunks/C0UOkQYV.js";import{m as he}from"../chunks/CSUflvoX.js";const be="movie-manager-web";var Pe=b("<!> <!> <!>",1),xe=b('<div class="flex items-center"><!> <a href="/forgot-password" class="ms-auto text-sm underline-offset-4 hover:underline">Forgot your password?</a></div> <!> <!>',1),we=b("<!> ",1),ye=b(`Don't have an account? <a href="/signup" class="underline underline-offset-4">Sign up</a>`,1),Ee=b('<div class="flex flex-col items-center gap-1 text-center"><h1 class="text-2xl font-bold">Login to your account</h1> <p class="text-sm text-balance text-muted-foreground">Enter your email below to login to your account</p></div> <!> <!> <!> <!>',1),Fe=b("<form><!></form>");function ke(T,c){const P=X();Y(c,!0);const y=ce.url.searchParams.get("email")||"";let E=ie(c,"ref",15,null),F=ue(c,["$$slots","$$events","$$legacy","ref","class"]),a=O({Email:y,Password:""}),m=Z(O({})),k=O({}),I=ve(()=>({mutationFn:async e=>pe(`${ge}/api/auth/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}));function A(e){const l=q.pick({[e]:!0}).safeParse({[e]:a[e]});l.success?delete r(m)[e]:r(m)[e]=l.error.issues[0].message}function M(e){k[e]=!0,A(e)}async function K(e){e.preventDefault(),Object.keys(a).forEach(v=>k[v]=!0);const S=q.safeParse(a);if(!S.success){re(m,Object.fromEntries(S.error.issues.map(v=>[v.path[0],v.message])),!0);return}const l=await I.mutateAsync({...a,ClientId:be});if(l.emailVerificationToken){V(`/verify-email?tkn=${l.emailVerificationToken}`);return}_e({user:l.userDetails}),V("/dashboard")}var x=Fe();te(x,e=>({onsubmit:K,class:e,...F}),[()=>ae("flex flex-col gap-6",c.class)]);var Q=_(x);me(Q,{children:(e,S)=>{var l=Ee(),v=o(D(l),2);L(v,{children:(p,B)=>{var i=Pe(),f=D(i);G(f,{for:"Email",children:(d,t)=>{w();var s=N("Email");u(d,s)},$$slots:{default:!0}});var n=o(f,2);{let d=$(()=>`${r(m)?.Email?"border-destructive":""}`),t=$(()=>M.bind(null,"Email"));R(n,{id:"Email",type:"email",get class(){return r(d)},placeholder:"m@example.com",get onblur(){return r(t)},oninput:()=>k.Email&&A("Email"),get value(){return a.Email},set value(s){a.Email=s}})}var g=o(n,2);{let d=$(()=>r(m)?.Email||""),t=$(()=>!!r(m)?.Email);U(g,{variant:"error",get message(){return r(d)},get show(){return r(t)}})}u(p,i)},$$slots:{default:!0}});var H=o(v,2);L(H,{children:(p,B)=>{var i=xe(),f=D(i),n=_(f);G(n,{get for(){return`password-${P}`},children:(t,s)=>{w();var C=N("Password");u(t,C)},$$slots:{default:!0}}),w(2),h(f);var g=o(f,2);{let t=$(()=>M.bind(null,"Password")),s=$(()=>`${r(m)?.Password?"border-destructive":""}`);R(g,{id:"Password",get onblur(){return r(t)},oninput:()=>k.Password&&A("Password"),get class(){return r(s)},type:"password",get value(){return a.Password},set value(C){a.Password=C}})}var d=o(g,2);{let t=$(()=>r(m)?.Password?"error":"info");U(d,{get variant(){return r(t)},message:"Must be at least 8 characters long."})}u(p,i)},$$slots:{default:!0}});var J=o(H,2);L(J,{children:(p,B)=>{se(p,{get disabled(){return I.isPending},type:"submit",children:(i,f)=>{var n=we(),g=D(n);{var d=s=>{$e(s,{})};de(g,s=>{I.isPending&&s(d)})}var t=o(g);z(()=>le(t,` ${I.isPending?"Logging in...":"Login"}`)),u(i,n)},$$slots:{default:!0}})},$$slots:{default:!0}});var W=o(J,2);L(W,{children:(p,B)=>{fe(p,{class:"text-center",children:(i,f)=>{w();var n=ye();w(),u(i,n)},$$slots:{default:!0}})},$$slots:{default:!0}}),u(e,l)},$$slots:{default:!0}}),h(x),ne(x,e=>E(e),()=>E()),u(T,x),ee()}var Ie=b('<div class="grid min-h-svh lg:grid-cols-2"><div class="flex flex-col gap-4 p-6 md:p-10"><div class="flex flex-1 items-center justify-center"><div class="w-full max-w-xs"><!></div></div></div> <div class="bg-muted relative hidden lg:block"><img alt="placeholder" class="absolute inset-0 h-full w-full object-cover dark:brightness-[0.8] dark:grayscale"/></div></div>');function Ve(T){var c=Ie(),P=_(c),j=_(P),y=_(j),E=_(y);ke(E,{}),h(y),h(j),h(P);var F=o(P,2),a=_(F);h(F),h(c),z(()=>oe(a,"src",he)),u(T,c)}export{Ve as component};
