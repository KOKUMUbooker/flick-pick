import{e as X,p as Y,g as Z,a as u,t as N,i as ee,f as b,r as re}from"../chunks/i2qjbZCX.js";import"../chunks/0TDw33Fi.js";import{p as te,K as C,L as ae,b as se,e as o,f as L,g as r,J as $,c as _,t as z,s as oe,n as w,r as h}from"../chunks/BjJVWsSe.js";import{d as le,c as ie,B as ne,b as de}from"../chunks/BCgBbjUq.js";import{s as ue}from"../chunks/BCxAJUJy.js";import{g as V}from"../chunks/CwPZXjMm.js";import{p as ce}from"../chunks/8BGKzr_V.js";import{F as me,a as T,b as K,I as R,H as U,c as fe,l as q}from"../chunks/DwCgtXDN.js";import{c as ve,a as pe,A as ge}from"../chunks/qcaP-jiJ.js";import{S as $e}from"../chunks/K6lY8tZ2.js";import{l as _e}from"../chunks/DBdLDcp1.js";import{m as he}from"../chunks/CSUflvoX.js";const be="movie-manager-web";var Pe=b("<!> <!> <!>",1),xe=b('<div class="flex items-center"><!> <a href="/forgot-password" class="ms-auto text-sm underline-offset-4 hover:underline">Forgot your password?</a></div> <!> <!>',1),we=b("<!> ",1),ye=b(`Don't have an account? <a href="/signup" class="underline underline-offset-4">Sign up</a>`,1),Ee=b('<div class="flex flex-col items-center gap-1 text-center"><h1 class="text-2xl font-bold">Login to your account</h1> <p class="text-sm text-balance text-muted-foreground">Enter your email below to login to your account</p></div> <!> <!> <!> <!>',1),ke=b("<form><!></form>");function Fe(j,c){const P=X();te(c,!0);const y=ce.url.searchParams.get("email")||"";let E=Y(c,"ref",15,null),k=re(c,["$$slots","$$events","$$legacy","ref","class"]),a=C({Email:y,Password:""}),m=ae(C({})),F=C({}),I=ve(()=>({mutationFn:async e=>pe(`${ge}/api/auth/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}));function A(e){const l=q.pick({[e]:!0}).safeParse({[e]:a[e]});l.success?delete r(m)[e]:r(m)[e]=l.error.issues[0].message}function M(e){F[e]=!0,A(e)}async function G(e){e.preventDefault(),Object.keys(a).forEach(v=>F[v]=!0);const S=q.safeParse(a);if(!S.success){oe(m,Object.fromEntries(S.error.issues.map(v=>[v.path[0],v.message])),!0);return}const l=await I.mutateAsync({...a,ClientId:be});if(l.emailVerificationToken){V(`/verify-email?tkn=${l.emailVerificationToken}`);return}_e({user:l.userDetails}),V("/dashboard")}var x=ke();le(x,e=>({onsubmit:G,class:e,...k}),[()=>ie("flex flex-col gap-6",c.class)]);var Q=_(x);me(Q,{children:(e,S)=>{var l=Ee(),v=o(L(l),2);T(v,{children:(p,B)=>{var i=Pe(),f=L(i);K(f,{for:"Email",children:(d,t)=>{w();var s=N("Email");u(d,s)},$$slots:{default:!0}});var n=o(f,2);{let d=$(()=>`${r(m)?.Email?"border-destructive":""}`),t=$(()=>M.bind(null,"Email"));R(n,{id:"Email",type:"email",get class(){return r(d)},placeholder:"m@example.com",get onblur(){return r(t)},oninput:()=>F.Email&&A("Email"),get value(){return a.Email},set value(s){a.Email=s}})}var g=o(n,2);{let d=$(()=>r(m)?.Email||""),t=$(()=>!!r(m)?.Email);U(g,{variant:"error",get message(){return r(d)},get show(){return r(t)}})}u(p,i)},$$slots:{default:!0}});var H=o(v,2);T(H,{children:(p,B)=>{var i=xe(),f=L(i),n=_(f);K(n,{get for(){return`password-${P}`},children:(t,s)=>{w();var O=N("Password");u(t,O)},$$slots:{default:!0}}),w(2),h(f);var g=o(f,2);{let t=$(()=>M.bind(null,"Password")),s=$(()=>`${r(m)?.Password?"border-destructive":""}`);R(g,{id:"Password",get onblur(){return r(t)},oninput:()=>F.Password&&A("Password"),get class(){return r(s)},type:"password",get value(){return a.Password},set value(O){a.Password=O}})}var d=o(g,2);{let t=$(()=>r(m)?.Password?"error":"info");U(d,{get variant(){return r(t)},message:"Must be at least 8 characters long."})}u(p,i)},$$slots:{default:!0}});var J=o(H,2);T(J,{children:(p,B)=>{ne(p,{get disabled(){return I.isPending},type:"submit",children:(i,f)=>{var n=we(),g=L(n);{var d=s=>{$e(s,{})};ee(g,s=>{I.isPending&&s(d)})}var t=o(g);z(()=>ue(t,` ${I.isPending?"Logging in...":"Login"}`)),u(i,n)},$$slots:{default:!0}})},$$slots:{default:!0}});var W=o(J,2);T(W,{children:(p,B)=>{fe(p,{class:"text-center",children:(i,f)=>{w();var n=ye();w(),u(i,n)},$$slots:{default:!0}})},$$slots:{default:!0}}),u(e,l)},$$slots:{default:!0}}),h(x),Z(x,e=>E(e),()=>E()),u(j,x),se()}var Ie=b('<div class="grid min-h-svh lg:grid-cols-2"><div class="flex flex-col gap-4 p-6 md:p-10"><div class="flex flex-1 items-center justify-center"><div class="w-full max-w-xs"><!></div></div></div> <div class="bg-muted relative hidden lg:block"><img alt="placeholder" class="absolute inset-0 h-full w-full object-cover dark:brightness-[0.8] dark:grayscale"/></div></div>');function Ne(j){var c=Ie(),P=_(c),D=_(P),y=_(D),E=_(y);Fe(E,{}),h(y),h(D),h(P);var k=o(P,2),a=_(k);h(k),h(c),z(()=>de(a,"src",he)),u(j,c)}export{Ne as component};
